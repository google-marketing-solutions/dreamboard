<div class="assets-container">
  <!-- Generated / Uploaded assets table -->
  <div class="mat-elevation-z8">
    <mat-form-field>
      <mat-label
        >Filter your {{ this.assetType }} in the table below.</mat-label
      >
      <input
        matInput
        (keyup)="applyFilter($event)"
        placeholder="Ex. My asset"
        #input
      />
    </mat-form-field>
    @if (isSelectionMode) {
      <div>
        <span
          ><strong>Note: </strong>The assets will be sent to the video
          generation model in the order you select them.</span
        >
      </div>
    }
    <table mat-table [dataSource]="dataSource" matSort>
      <!-- Preview Column -->
      <ng-container matColumnDef="assetPreview">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Asset Preview</th>
        <td mat-cell *matCellDef="let row">
          @if (row.mimeType.includes("image")) {
            <img [src]="row.signedUri" />
            <label>{{ row.name }}</label>
          } @else if (row.mimeType.includes("video")) {
            <video controls>
              <source [src]="row.signedUri" [type]="row.mimeType" />
            </video>
          }
        </td>
      </ng-container>

      <!-- Checkbox Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>
          @if (!isSelectionMode) {
            Actions
          } @else {
            <!-- Show this only in Video Generation Settings -->
            <button
              mat-flat-button
              color="warn"
              matTooltip="Clear All"
              (click)="clearAllSelections(); $event.stopPropagation()"
            >
              Clear All
            </button>
          }
        </th>
        <td mat-cell *matCellDef="let row">
          @if (!isSelectionMode) {
            <button
              mat-icon-button
              color="warn"
              matTooltip="Delete Asset"
              (click)="onDeleteAsset(row); $event.stopPropagation()"
            >
              <mat-icon>delete</mat-icon>
            </button>
          } @else {
            <!-- Show this only in Video Generation Settings -->
            <mat-checkbox
              [disabled]="disableCheckBox(row)"
              class="selected-asset-for-video-checkbox"
              (click)="$event.stopPropagation()"
              (change)="$event ? toggleSingleRow(row) : null"
              [checked]="selection.isSelected(row)"
              [aria-label]="checkboxLabel(row)"
            >
            </mat-checkbox>
          }
        </td>
      </ng-container>

      <!-- Paginator -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">* No assets found! *</td>
      </tr>
    </table>

    <mat-paginator
      [pageSizeOptions]="getPageSizeOptions()"
      aria-label="Select page of users"
    ></mat-paginator>
  </div>
</div>
